<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestion des Messages - Admin Bloom</title>
    <link rel="icon" type="image/png" href="/images/title-icon.webp">
    <link rel="stylesheet" href="/styles/style.css">
    <link rel="stylesheet" href="/styles/admin.css">
</head>
<body class="no-scroll">
    <%- include('partials/admin-header') %>

    <main class="admin-main">
         <header class="admin-header">
            <h1>Messages ReÃ§us</h1>
            <a href="/admin/dashboard" class="admin-btn-back">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                <span>Tableau de Bord</span>
            </a>
        </header>

        <div class="admin-messages-container">
            <% if (messages && messages.length > 0) { %>
                <div class="admin-messages-list">
                    <% messages.forEach(msg => { %>
                        <div class="admin-message-row" data-message-id="<%= msg._id %>">
                            <div class="message-summary">
                                <span class="message-from"><%= msg.name %></span>
                                <span class="message-subject"><%= msg.subject %></span>
                                <span class="message-date"><%= new Date(msg.createdAt).toLocaleDateString('fr-FR', { day: '2-digit', month: 'short', year: 'numeric' }) %></span>
                                <div class="message-actions">
                                    <button class="btn-delete-message" aria-label="Supprimer le message">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
                                    </button>
                                    <span class="expand-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"></polyline></svg>
                                    </span>
                                </div>
                            </div>
                            <div class="message-content">
                                <p><strong>Email :</strong> <a href="mailto:<%= msg.email %>"><%= msg.email %></a></p>
                                <p class="message-body"><%- msg.message.replace(/\n/g, '<br>') %></p>
                            </div>
                        </div>
                    <% }) %>
                </div>
            <% } else { %>
                <div class="admin-no-orders-message">
                    <p>Vous n'avez aucun nouveau message.</p>
                </div>
            <% } %>
        </div>
    </main>
    
    <%- include('partials/admin-modals') %>
    <script src="/functions/script.js"></script>
    <script src="/functions/admin.js"></script>
  
</body>
</html>